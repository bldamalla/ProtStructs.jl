<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Structure Frames · ProtStructs</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ProtStructs</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../start/">Brief walkthrough</a></li><li><span class="tocitem">Models</span><ul><li class="is-active"><a class="tocitem" href>Structure Frames</a><ul class="internal"><li><a class="tocitem" href="#StructureFrames"><span>StructureFrames</span></a></li><li><a class="tocitem" href="#Residues-and-JResidue"><span>Residues and <code>JResidue</code></span></a></li><li><a class="tocitem" href="#Atoms-and-JAtom"><span>Atoms and <code>JAtom</code></span></a></li><li><a class="tocitem" href="#Tools-on-StructureFrames"><span>Tools on StructureFrames</span></a></li><li class="toplevel"><a class="tocitem" href="#Abstract-Frames"><span>Abstract Frames</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../API/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li class="is-active"><a href>Structure Frames</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Structure Frames</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bldamalla/ProtStructs.jl/blob/master/docs/src/structs/sfs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Structure-Frames-and-related-constructs"><a class="docs-heading-anchor" href="#Structure-Frames-and-related-constructs">Structure Frames and related constructs</a><a id="Structure-Frames-and-related-constructs-1"></a><a class="docs-heading-anchor-permalink" href="#Structure-Frames-and-related-constructs" title="Permalink"></a></h1><p>Throughout the model, the concept of a StructureFrame is used. It is a representation of a configuration of a set of atoms, molecules, or residues that are used to describe protein structure. As proteins are flexible polymers, it was deemed reasonable to write representations that can be recycled easily when only the atomic positions change and not the system topology (atom and residue numbers and connectivities).</p><p>This is also partly the reason why <code>StructureFrame</code>s are not hierarchical models.</p><h2 id="StructureFrames"><a class="docs-heading-anchor" href="#StructureFrames">StructureFrames</a><a id="StructureFrames-1"></a><a class="docs-heading-anchor-permalink" href="#StructureFrames" title="Permalink"></a></h2><p>As was introduced in the walkthrough, reading PDB files yields <code>StructureFrame</code> objects. This terminology comes from Chemfiles (historic).</p><p><code>StructureFrame</code> objects are defined as the following:</p><pre><code class="language-julia hljs">struct StructureFrame
    step::UInt
    at_pos::Vector{SVector{3,T&lt;:AbstractFloat}}
    at_list::Vector{JAtom}
    res_list::Vector{JResidue}
end</code></pre><p>Above <code>JAtom</code> and <code>JResidue</code> types structs correspond to <code>Atom</code> and <code>Residue</code> types from Chemfiles. They are named as such to not have naming conflicts between modules. These types are explored further in subsections below.</p><p>The <code>step</code> property is an integer dictating the step number of a frame, in a possibly unordered collection of frames<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, and can be used to sort frames accordingly. This frame has its own set of positions for each atom. Thus, a limitation that <code>length(at_pos) == length(at_list)</code> must be imposed.</p><p>Now, each atom in the frame belongs to a residue, whether it be an amino acid, nucleic acid, ligand, ion, or solvent. Residues must be mutually exclusive, <em>i.e.</em> an atom belongs to <em>exactly one</em> residue. There is no imposed order on residues, but it is expected that they are grouped by &quot;chains&quot; and are ordered by their respective sequence numbers (for amino/nucleic acids).</p><h2 id="Residues-and-JResidue"><a class="docs-heading-anchor" href="#Residues-and-JResidue">Residues and <code>JResidue</code></a><a id="Residues-and-JResidue-1"></a><a class="docs-heading-anchor-permalink" href="#Residues-and-JResidue" title="Permalink"></a></h2><p>Residues are a collection of atoms corresponding to a logical unit. For proteins or nucleic acids (standard PDB residues) they are amino acid residues and nucleic acid residues, respecitively. In PDB files, atoms of these residues are annotated as <code>ATOM</code>. In addition to these, other atoms may be listed such as water molecules or ligands such as heme. Atoms of these residues are annotated as <code>HETATM</code>.</p><p><a href="../../API/#ProtStructs.JResidue"><code>JResidue</code></a> structs have the following properties:</p><ul><li><code>chainid::String</code>: chain identifier of the residue in which it belongs</li><li><code>name::Symbol</code>: name of the residue as described in the PDB input</li><li><code>standard_pdb:Bool</code>: whether atoms in the residue are annotated with <code>ATOM</code> or <code>HETATM</code><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></li><li><code>at_dict</code>: <code>Dict</code> object containing symbols to indices of <code>JAtoms</code> included in the residue</li></ul><p>Types of members are experimental and are expected to change depending on usage and benchmark tests.</p><p>Entries of the <code>at_dict</code> property are of the form <code>:CA=&gt;0x02</code> suggesting that an atom with name <code>:CA</code> belonging to this residue can be found at index <code>0x02</code> of the <code>at_list</code> property of the parent StructureFrame. Similarly, its position can be found at the same index of the <code>at_pos</code> property.</p><p>For readability, the function <code>getatom</code> is provided</p><pre><code class="language-julia hljs"># here res is a JResidue
Nid = res.at_dict[:N]       # gives index of the amide nitrogen in the residue
frame.at_pos[Nid]           # its atomic coordinates
frame.at_list[Nid]          # its atom properties

Nid == getatom(res, :N)     # the same behavior as res.at_dict[:N]</code></pre><p>For there are plans for abstraction of this residue type, it is recommended to use <code>getatom</code> in code using this behavior.</p><h2 id="Atoms-and-JAtom"><a class="docs-heading-anchor" href="#Atoms-and-JAtom">Atoms and <code>JAtom</code></a><a id="Atoms-and-JAtom-1"></a><a class="docs-heading-anchor-permalink" href="#Atoms-and-JAtom" title="Permalink"></a></h2><p>Atoms are the particles being tracked in full-atom simulations/calculations. Representations can contain information such as the mass and charge of the particle. The module exports the <a href="../../API/#ProtStructs.JAtom"><code>JAtom</code></a> struct containing the following fields:</p><ul><li><code>name::Symbol</code>: atom name that can be used for referencing;</li><li><code>type::String</code>: atom (nucleus) element type;</li><li><code>mass::T&lt;:AbstractFloat</code>: atom mass;</li><li><code>charge::T&lt;:AbstractFloat</code>: atom charge</li></ul><p>Note that this is only a subset of the information that can be obtained from a Chemfiles Frame. There are plans to declare this as a subtype of <code>AbstractAtom</code> to allow for different atom types containing various pieces of information depending on the analyses.</p><h2 id="Tools-on-StructureFrames"><a class="docs-heading-anchor" href="#Tools-on-StructureFrames">Tools on StructureFrames</a><a id="Tools-on-StructureFrames-1"></a><a class="docs-heading-anchor-permalink" href="#Tools-on-StructureFrames" title="Permalink"></a></h2><p>Summarized here are some tools on StructureFrames that can be found useful in analysis.</p><h3 id="Backbone-proton-addition"><a class="docs-heading-anchor" href="#Backbone-proton-addition">Backbone proton addition</a><a id="Backbone-proton-addition-1"></a><a class="docs-heading-anchor-permalink" href="#Backbone-proton-addition" title="Permalink"></a></h3><p>Not all input files are made equal: some may have protons, while some may not. The package provides a function <a href="../../API/#ProtStructs.addprotons!"><code>addprotons!</code></a> to add protons to the protein backbone (amide hydrogens), when applicable. Positions of protons are inferred according to the following rules:</p><ul><li>Amide functional group (peptide bond) is planar</li><li>N-H bond length is 1 Angstrom</li></ul><p>The second rule is assumed by DSSP in calculating energies of hydrogen bonds (for secondary structure assignment). Using this method on structures that already have atoms, <em>does not</em> remove atoms from the frame, but instead adds the new backbone proton and <em>replaces</em> the reference index to that of the added proton using <a href="../../API/#ProtStructs.setatom!"><code>setatom!</code></a>.</p><p>The function call is</p><pre><code class="language-julia hljs">addprotons!(frame)</code></pre><h3 id="Chain-dictionary"><a class="docs-heading-anchor" href="#Chain-dictionary">Chain dictionary</a><a id="Chain-dictionary-1"></a><a class="docs-heading-anchor-permalink" href="#Chain-dictionary" title="Permalink"></a></h3><p>Sometimes it is useful to get a dictionary of the chain identifiers of each residue without having to calculate it all over again. This can potentially speed up calculations that rely on chain connectivities. It was found necessary to separate this function: a clear disadvantage of not using a hierarchical model.</p><p>The <a href="../../API/#ProtStructs.getchaindict"><code>getchaindict</code></a> function assumes that the input StructureFrame has  its standard (PDB) residues arranged by sequence number and that all are  within a chain. Normally, nucleic acid chains in crystal structures are  labelled in a different chain.</p><p>The function call is</p><pre><code class="language-julia hljs">chaindict = getchaindict(frame)</code></pre><h1 id="Abstract-Frames"><a class="docs-heading-anchor" href="#Abstract-Frames">Abstract Frames</a><a id="Abstract-Frames-1"></a><a class="docs-heading-anchor-permalink" href="#Abstract-Frames" title="Permalink"></a></h1><p>There are plans to extend the current functionality to abstract types. So far, two flavors are in mind:</p><ul><li><code>SFLike</code> implementations similar to <code>StructureFrame</code>;</li><li>other frame implementations</li></ul><p><code>StructureFrame</code>-like constructs can be assigned to act like <code>StructureFrames</code>. This can make current <em>basic</em> definitions on <code>StructureFrame</code>s apply to the new types. Extension is thought to be based on properties, <em>i.e.</em> overloading <code>Base.getproperty</code>.</p><p>As of now, there are no plans regarding hierarchical frame structures.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>One way this can happen is through parallel reading of input. In principle, it can be done, though it is not recommended.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Name is derived from Chemfiles.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../start/">« Brief walkthrough</a><a class="docs-footer-nextpage" href="../../API/">API Documentation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Saturday 5 March 2022 06:42">Saturday 5 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
