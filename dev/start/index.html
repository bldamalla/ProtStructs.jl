<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Brief walkthrough · ProtStructs</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ProtStructs</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Brief walkthrough</a><ul class="internal"><li><a class="tocitem" href="#Reading-from-PDB-and-StructureFrames"><span>Reading from PDB and <code>StructureFrames</code></span></a></li><li><a class="tocitem" href="#Protons-and-hydrogen-bonding"><span>Protons and hydrogen bonding</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li></ul></li><li><span class="tocitem">Models</span><ul><li><a class="tocitem" href="../structs/sfs/">Structure Frames</a></li></ul></li><li><a class="tocitem" href="../API/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Brief walkthrough</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Brief walkthrough</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bldamalla/ProtStructs.jl/blob/master/docs/src/start.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Brief-walkthrough"><a class="docs-heading-anchor" href="#Brief-walkthrough">Brief walkthrough</a><a id="Brief-walkthrough-1"></a><a class="docs-heading-anchor-permalink" href="#Brief-walkthrough" title="Permalink"></a></h1><p>As introduced, the module provides some types and methods for reading PDB files, which can be integrated with trajectories from files that can be read using Chemfiles.jl. Most of these are used for secondary structure assignments.</p><p>Most of the needed information regarding protein structure is contained in a <code>StructureFrame</code> construct. Functions acting on the <code>StructureFrame</code> or its derivatives can yield useful information regarding structure. These functions will be introduced later on.</p><h2 id="Reading-from-PDB-and-StructureFrames"><a class="docs-heading-anchor" href="#Reading-from-PDB-and-StructureFrames">Reading from PDB and <code>StructureFrames</code></a><a id="Reading-from-PDB-and-StructureFrames-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-from-PDB-and-StructureFrames" title="Permalink"></a></h2><p>The module provides two ways of generating <code>StructureFrame</code>s from PDB files:</p><ul><li>From a Chemfiles <code>Frame</code> object;</li><li>Directly from PDB files</li></ul><h3 id="Reading-from-a-Chemfiles-Frame"><a class="docs-heading-anchor" href="#Reading-from-a-Chemfiles-Frame">Reading from a Chemfiles Frame</a><a id="Reading-from-a-Chemfiles-Frame-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-from-a-Chemfiles-Frame" title="Permalink"></a></h3><p>A <code>StructureFrame</code> can be obtained from extracting information from a Chemfiles Frame through the <code>extractframe</code> function:</p><pre><code class="language-julia hljs">import Chemfiles

structs = Chemfiles.Trajectory(&quot;path/to/file.pdb&quot;) do traj
    frame = read(traj)      ## obtains a Frame object
    extractframe(frame)     ## extract from the frame to get StructureFrame
end</code></pre><p>So far, this extraction method takes <em>a long time</em> to complete. If performance in reading structures is not as important, then one may choose to use this method. Otherwise, if performance is critical, it may be wiser to extract directly from PDB files, as shown in the next subsection.</p><h3 id="Reading-directly-from-PDB-files"><a class="docs-heading-anchor" href="#Reading-directly-from-PDB-files">Reading directly from PDB files</a><a id="Reading-directly-from-PDB-files-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-directly-from-PDB-files" title="Permalink"></a></h3><p>A <code>StructureFrame</code> can also be parsed from information directly from a PDB file. However, note that the amount of information about atoms is limited for this method compared to the first <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><pre><code class="language-julia hljs">using ProtStructs

structs = read(&quot;path/to/file.pdb&quot;, StructureFrame)</code></pre><p>In at least one benchmark, the above parsing method is only slightly faster than that provided by BioStructures.jl. This is likely due to the fact that less information is read and that the data model is <em>not hierarchical</em>.</p><h3 id="On-the-StructureFrame-object"><a class="docs-heading-anchor" href="#On-the-StructureFrame-object">On the <code>StructureFrame</code> object</a><a id="On-the-StructureFrame-object-1"></a><a class="docs-heading-anchor-permalink" href="#On-the-StructureFrame-object" title="Permalink"></a></h3><p><code>StructureFrame</code> objects are defined as the following:</p><pre><code class="language-julia hljs">struct StructureFrame
    step::UInt
    at_pos::Vector{SVector{3,T&lt;:AbstractFloat}}
    at_list::Vector{JAtom}
    res_list::Vector{JResidue}
end</code></pre><p>Above <code>JAtom</code> and <code>JResidue</code> types structs correspond to <code>Atom</code> and <code>Residue</code> types from Chemfiles. They are named as such to not have naming conflicts between modules.</p><p>The <code>step</code> property is an integer dictating the step number, formally in a  trajectory, of a particular system. The frame has its own set of positions  contained in <code>at_pos</code> property. Each of these positions is of an atom in  residing in the same index in <code>at_list</code>.</p><p><code>JResidue</code> structs have the following properties:</p><ul><li><code>chainid</code>: chain identifier of the residue in which it belongs</li><li><code>name</code>: name of the residue as described in the PDB input</li><li><code>standard_pdb</code>: whether atoms in the residue are annotated with <code>ATOM</code> or</li></ul><p><code>HETATM</code><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><ul><li><code>at_dict</code>: <code>Dict</code> object containing symbols to indices of <code>JAtoms</code> included in</li></ul><p>the residue</p><h2 id="Protons-and-hydrogen-bonding"><a class="docs-heading-anchor" href="#Protons-and-hydrogen-bonding">Protons and hydrogen bonding</a><a id="Protons-and-hydrogen-bonding-1"></a><a class="docs-heading-anchor-permalink" href="#Protons-and-hydrogen-bonding" title="Permalink"></a></h2><p>In the DSSP secondary structure assignment scheme, secondary structures are determined from hydrogen bonding patterns between backbone elements. For this, the module provides the <code>HBondDict</code> type for storing information on these.</p><h3 id="Proton-guessing-and-placement"><a class="docs-heading-anchor" href="#Proton-guessing-and-placement">Proton guessing and placement</a><a id="Proton-guessing-and-placement-1"></a><a class="docs-heading-anchor-permalink" href="#Proton-guessing-and-placement" title="Permalink"></a></h3><p>In some PDB files, positions of protons along the backbone are not given. This is generally the case in lower resolution structures. Adding protons to the backbone of peptide chains can be done through calling</p><pre><code class="language-julia hljs">addprotons!(frame)</code></pre><p>This <em>mutates</em> the passed <code>StructureFrame</code> to have protons in its <code>at_list</code> property. Their positions are inferred based on similar rules as with DSSP:</p><ol><li>The amide bond remains planar with dihedral angle <code>\pi</code>;</li><li>The <span>$N--H$</span> bond has length <span>$1$</span> Angstrom.</li></ol><h3 id="HBondDict-construct-and-elementary-patterns"><a class="docs-heading-anchor" href="#HBondDict-construct-and-elementary-patterns"><code>HBondDict</code> construct and elementary patterns</a><a id="HBondDict-construct-and-elementary-patterns-1"></a><a class="docs-heading-anchor-permalink" href="#HBondDict-construct-and-elementary-patterns" title="Permalink"></a></h3><p>Note that <code>HBondDict &lt;: AbstractDict</code>, so it can be <em>iterated</em> and accessed like a <code>Dict</code>. The preferred constructor is <code>HBondDict(N)</code> where <span>$N \in \{1,2\}$</span>. This constructs a hydrogen bonding dictionary for a particular residue. Entries are stored as <code>(index, energy)</code> where <code>index</code> is the index in the <code>res_list</code> property of the <em>original frame</em> to which a specific residue is bonded. These can be accessed using symbols such as <code>:d1</code> and <code>:a2</code>.</p><p>As an example, suppose that for a particular residue, we want to record at most two residues acting as either donors or acceptors. After some calculations it was found that a residue at index <code>di</code> acts as a donor with bonding energy <code>Ei</code> and that a residue at index <code>aj</code> acts as an acceptor with bonding energy <code>Ej</code>. This can be stored in a <code>HBondDict</code> as:</p><pre><code class="language-julia hljs">dict = HBondDict(2)     ## store at most two donor or acceptor residues
dict[:d1] = (di, Ei)    ## store as a first hbond donor
dict[:a2] = (aj, Ej)    ## store as a second hbond acceptor</code></pre><p>Using this construct, simple functions regarding hydrogen bonds in the backbone can be defined. The <code>hbonded</code> function checks the input dictionary of a residue to see if a residue acts as an hydrogen bond <em>acceptor</em>.</p><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><p>Certain geometric concepts are also included. Instead of working on the frame objects themselves, the included functions act on points, preferrably <code>SVector{3}</code> objects. These include:</p><ul><li><code>distance(a, b)</code>: euclidean distance between points <span>$A$</span>, <span>$B$</span>;</li><li><code>anglespan(a, b, c)</code>: angle spanned by <span>$\angle{ABC}$</span>;</li><li><code>dihedral(a, b, c, d)</code>: <em>right handed</em> torsion (dihedral) angle between planes</li></ul><p>spanned by <span>$ABC$</span> and <span>$BCD$</span></p><p>Unweighted centroids of points and root-mean-square deviations (rmsds) of sets of points can also be calculated.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>This will be fixed soon if there is sufficient motivation to do so. So far, it is not <em>yet</em> needed.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>This terminology is borrowed from Chemfiles.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../structs/sfs/">Structure Frames »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Saturday 5 March 2022 04:44">Saturday 5 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
